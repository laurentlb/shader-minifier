// Generated with  (https://github.com/laurentlb/Shader_Minifier/)
# define VAR_mouse "s"
# define VAR_resolution "v"
# define VAR_tex0 "y"
# define VAR_tex1 "f"
# define VAR_tex2 "o"
# define VAR_tex3 "w"
# define VAR_time "z"

// tests/real/kinder_painter.frag
"uniform vec2 v;"
 "uniform float z;"
 "uniform vec4 s;"
 "uniform sampler2D y,f,o,w;"
 "vec4 r[6],b[6];"
 "float t(vec4 z,vec3 m,vec3 v)"
 "{"
   "vec3 r=m-z.xyz;"
   "float w=dot(v.xz,v.xz),d=dot(v.xz,r.xz),b;"
   "b=d*d-w*(dot(r.xz,r.xz)-z.w*z.w);"
   "if(b>0.)"
     "b=(-d-sqrt(b))/w;"
   "return b-.001;"
 "}"
 "float d(vec4 z,vec3 m,vec3 v)"
 "{"
   "vec3 r=m-z.xyz;"
   "float d=dot(v,r),b=d*d-dot(r,r)+z.w*z.w;"
   "if(b>0.)"
     "b=-d-sqrt(b);"
   "return b-.001;"
 "}"
 "bool d(vec4 z,vec3 m,vec3 v,float w)"
 "{"
   "vec3 r=m-z.xyz;"
   "float d=dot(v,r),b=d*d-dot(r,r)+z.w*z.w;"
   "bool f=false;"
   "if(b>0.)"
     "b=-d-sqrt(b),f=b>0.&&b<w;"
   "return f;"
 "}"
 "bool t(vec4 z,vec3 m,vec3 v,float w)"
 "{"
   "vec3 r=m-z.xyz;"
   "float d=dot(v.xz,v.xz),b=dot(v.xz,r.xz),f=b*b-d*(dot(r.xz,r.xz)-z.w*z.w);"
   "bool o=false;"
   "if(f>0.)"
     "f=-b-sqrt(f),o=f>0.&&f<w*d;"
   "return o;"
 "}"
 "float n(vec4 v,vec3 z,vec3 r)"
 "{"
   "float b=dot(v.xyz,r);"
   "b=sign(b)*max(abs(b),.001);"
   "float d=(-dot(v.xyz,z)-v.w)/b;"
   "return d-.001;"
 "}"
 "vec3 n(vec4 v,vec4 z,vec3 m,out vec2 r)"
 "{"
   "vec3 b;"
   "r=z.w>2.5?"
     "(b.xz=m.xz-v.xz,b.y=0.,b/=v.w,vec2(b.x,m.y)):"
     "z.w>1.5?"
       "(b=v.xyz,m.xz*.2):"
       "(b=m-v.xyz,b/=v.w,b.xy);"
   "return b;"
 "}"
 "vec4 m(vec4 z,vec4 v,bool r)"
 "{"
   "return r?"
     "v:"
     "z;"
 "}"
 "float m(float z,float v,bool r)"
 "{"
   "return r?"
     "v:"
     "z;"
 "}"
 "int m(int z,int v,bool r)"
 "{"
   "return r?"
     "v:"
     "z;"
 "}"
 "float m(vec3 v,vec3 z,out vec4 f,out vec4 w)"
 "{"
   "float y=1e4,o;"
   "w.w=-1.;"
   "bool i;"
   "o=d(r[0],v,z);"
   "i=o>0.&&o<y;"
   "f=m(f,r[0],i);"
   "w=m(w,b[0],i);"
   "y=m(y,o,i);"
   "o=d(r[1],v,z);"
   "i=o>0.&&o<y;"
   "f=m(f,r[1],i);"
   "w=m(w,b[1],i);"
   "y=m(y,o,i);"
   "o=t(r[2],v,z);"
   "i=o>0.&&o<y;"
   "f=m(f,r[2],i);"
   "w=m(w,b[2],i);"
   "y=m(y,o,i);"
   "o=t(r[3],v,z);"
   "i=o>0.&&o<y;"
   "f=m(f,r[3],i);"
   "w=m(w,b[3],i);"
   "y=m(y,o,i);"
   "o=n(r[4],v,z);"
   "i=o>0.&&o<y;"
   "f=m(f,r[4],i);"
   "w=m(w,b[4],i);"
   "y=m(y,o,i);"
   "o=n(r[5],v,z);"
   "i=o>0.&&o<y;"
   "f=m(f,r[5],i);"
   "w=m(w,b[5],i);"
   "y=m(y,o,i);"
   "return y;"
 "}"
 "bool x(vec3 v,vec3 z,float i)"
 "{"
   "bvec4 b;"
   "b.x=d(r[0],v,z,i);"
   "b.y=d(r[1],v,z,i);"
   "b.z=t(r[2],v,z,i);"
   "b.w=t(r[3],v,z,i);"
   "return any(b);"
 "}"
 "vec4 d(vec3 v,vec4 z,vec4 b,vec3 r,vec4 i,out vec4 f)"
 "{"
   "vec3 w;"
   "float d,o;"
   "vec2 m;"
   "w=n(z,b,v,m);"
   "d=dot(w,i.xyz);"
   "f.xyz=reflect(r,w);"
   "o=dot(f.xyz,i.xyz);"
   "o=max(o,0.);"
   "o*=o;"
   "o*=o;"
   "if(x(v,i.xyz,i.w))"
     "d=0.;"
   "b*=texture2D(y,m);"
   "d=max(d,0.);"
   "b=b*(vec4(.3,.34,.38,1)+.5*vec4(1,.95,.8,1)*d)+.5*o;"
   "d=dot(w,-r);"
   "f.w=d;"
   "d=1.-d*d;"
   "d*=d;"
   "b+=.35*vec4(d);"
   "return b;"
 "}"
 "void main()"
 "{"
   "vec4 f,i,w,o;"
   "vec2 y=-1.+2.*gl_FragCoord.xy/v.xy;"
   "y*=vec2(v.x/v.y,1);"
   "r[0]=vec4(1.2*sin(2.073423*z),0,1.8*sin(2.450409*z+1.),1);"
   "r[1]=vec4(1.5*sin(1.947761*z+4.),sin(1.822099*z+1.9),1.8*sin(1.822099*z),1);"
   "r[2]=vec4(-1.2,0,0,.4);"
   "r[3]=vec4(1.2,0,0,.4);"
   "r[4]=vec4(0,1,0,2);"
   "r[5]=vec4(0,-1,0,2);"
   "b[0]=vec4(.9,.8,.6,1);"
   "b[1]=vec4(1,.6,.4,1);"
   "b[2]=vec4(.8,.6,.5,3);"
   "b[3]=vec4(.5,.5,.7,3);"
   "b[4]=vec4(1,.9,.9,2);"
   "b[5]=vec4(1,.9,.9,2);"
   "float x=.15*z-6.2831*s.x/v.x,a=2.+3.*s.y/v.y;"
   "vec2 g=vec2(cos(x),sin(x));"
   "vec3 n=normalize(vec3(y.x*g.x-g.y,y.y,g.x+y.x*g.y)),t=vec3(a*g.y,0,-a*g.x);"
   "float u=m(t,n,i,w);"
   "vec3 e=t+n*u;"
   "f.xyz=vec3(0,1.5,-3)-e;"
   "f.w=length(f.xyz);"
   "f.xyz=f.xyz/f.w;"
   "w=d(e,i,w,n,f,o);"
   "vec4 C,D;"
   "u=m(e,o.xyz,i,C);"
   "e+=o.xyz*u;"
   "f.xyz=vec3(0,1.5,-1)-e;"
   "f.w=length(f.xyz);"
   "f.xyz=f.xyz/f.w;"
   "C=d(e,i,C,o.xyz,f,D);"
   "w=mix(w,C,.5-.5*o.w);"
   "gl_FragColor=w;"
 "}",
